# Lab: SSRF with filter bypass via open redirection vulnerability

**Link**: https://portswigger.net/web-security/ssrf/lab-ssrf-filter-bypass-via-open-redirection

**Solution**:

Notice it takes a path `/product/stock/check?productId=2&storeId=1` then, the stock feature is only local feature in the app

<p align="center" width="100%">
  <img src="image1.png" width="800" hight="500"/>
</p>
And there is a lot of validations here

There is another button takes URL. and then redirect you to the given URL called `Next product`

<p align="center" width="100%">
  <img src="image2.png" width="800" hight="500"/>
</p>

<p align="center" width="100%">
  <img src="image3.png" width="800" hight="500"/>
</p>

<p align="center" width="100%">
  <img src="image4.png" width="800" hight="500"/>
</p>

When click on follow redirection,

<p align="center" width="100%">
  <img src="image5.png" width="800" hight="500"/>
</p>

So there is Open Redirection Vuln here,

we can make use of it, to give the SSRF url the full path of open redirection vuln

instead of 

- stockApi=/product/stock/check?productId=2&storeId=1

add the full redirect path of `Next Product` link

- stockApi=/product/nextProduct?currentProductId=2&path=http://google.com

If we encode it

<p align="center" width="100%">
  <img src="image6.png" width="800" hight="500"/>
</p>

<p align="center" width="100%">
  <img src="image7.png" width="800" hight="500"/>
</p>

<p align="center" width="100%">
  <img src="image8.png" width="800" hight="500"/>
</p>
